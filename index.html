<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Remnant | Archive Your Memories</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="styles/main.css" />
    <link rel="icon" href="images/logo-mark.png" type="image/png" />
  </head>
  <body>
    <a class="skip-link" href="#story">Skip to content</a>
    <div
      class="coming-soon"
      data-coming-soon-modal
      data-modal-open="false"
      role="dialog"
      aria-modal="true"
      aria-labelledby="coming-soon-title"
      aria-hidden="true"
    >
      <div class="coming-soon__dialog">
        <button
          class="coming-soon__close"
          type="button"
          aria-label="Dismiss coming soon notice"
          data-modal-close
        >
          &times;
        </button>
        <p class="eyebrow">Coming Soon</p>
        <h2 id="coming-soon-title">This experience is still in development</h2>
        <p>
          We&apos;re building the full Remnant System. Explore the preview while we finish the launch.
        </p>
      </div>
    </div>
    <header class="shell" data-shell>
  <nav class="nav" aria-label="Primary">
    <!-- NEW: logged-in badge, visually outside the bubble -->
    <div class="auth-badge" data-auth-status hidden aria-live="polite">
      <span class="auth-badge__label">Logged in as</span>
      <span class="auth-badge__email" data-auth-email></span>
    </div>

    <a class="nav__brand" href="#top" aria-label="Remnant home">
      <img
        src="images/logo-mark.png"
        alt="Remnant"
        class="nav__logo"
        width="40"
        height="40"
      />
      <span class="nav__wordmark">emnant</span>
    </a>

    <button
      class="nav__toggle"
      type="button"
      aria-expanded="false"
      aria-controls="primary-menu"
    >
      <span class="sr-only">Toggle navigation</span>
      <svg class="nav__toggle-icon" width="28" height="28" viewBox="0 0 24 24" role="img" aria-hidden="true">
        <path class="nav__toggle-icon-bars" d="M4 6h16M4 12h16M4 18h16"
              stroke="currentColor" stroke-width="2" stroke-linecap="round" />
      </svg>
    </button>

    <div class="nav__cluster">
      <!-- REMOVED: the old .nav__status that sat inside the menu -->
      <div class="nav__links" id="primary-menu">
        <a href="#top" class="nav__link nav__link--active" aria-current="page">Home</a>
        <a href="how-it-works/" class="nav__link">How it works</a>
        <a href="stories/" class="nav__link">Stories</a>
        <a href="signup/" class="nav__link" data-auth-visible="signed-out">Sign Up</a>
        <a
          href="#"
          class="nav__link nav__link--logout"
          data-auth-visible="signed-in"
          data-logout
          data-logout-redirect="/signin/"
          hidden
        >
          Log Out
        </a>
        <div class="nav__cta">
          <a class="btn btn--primary" href="order/">Schedule Scan</a>
          <a class="btn btn--accent" href="vault/">Enter Vault</a>
          <a class="btn btn--ghost" href="support/">Support</a>
        </div>
      </div>
    </div>
  </nav>
</header>



    <main>
      <section class="hero" id="top">
        <div
          class="auth-badge auth-badge--mobile"
          data-auth-status-mobile
          hidden
          aria-live="polite"
        >
          <span class="auth-badge__label">Logged in as</span>
          <span class="auth-badge__email" data-auth-email-mobile></span>
        </div>
        <div class="hero__canvas-wrapper" data-hero-container>
          <video
            autoplay
            muted
            loop
            playsinline
            class="hero__poster"
            data-hero-poster
            disablePictureInPicture
            controlslist="nodownload nofullscreen noremoteplayback"
          >
            <source src="videos/logo-poster.mov" type="video/quicktime" />
            <!-- Fallback: -->
            <source src="videos/logo-poster.mp4" type="video/mp4" />
            Your browser does not support the video tag.
          </video>
          <canvas
            class="hero__canvas"
            data-hero-canvas
            aria-hidden="true"
          ></canvas>
        </div>
        <div class="hero__copy">
          <p class="eyebrow">Preserve. Revisit. Feel again.</p>
          <h1>Technology that keeps <br> memories alive.</h1>
          <p>
            Introducing Remnant. We capture your space as a ultra-realistic 3D experience, and deliver it to your secure Remnant Memory Vault. Log
            in to relive every detail.
          </p>
          <div class="hero__actions">
            <a class="btn btn--primary" href="order/">Book the Scan</a>
            <a class="btn btn--accent" href="vault/">Explore the Memory Vault</a>
          </div>
          <div class="hero__convai" data-convai-widget>
            <div class="hero__convai-frame">
              <elevenlabs-convai agent-id="agent_4801k7g6mcw9e2k9tr660wde8re4"></elevenlabs-convai>
            </div>
            <p class="hero__convai-caption">
              Meet John, our Remnant Q&A Bot,
               Ask him to place an order!
            </p>
          </div>
        </div>
      </section>

      <section class="story" id="story">
        <div class="section-heading">
          <h2>From capture to archive in three phases</h2>
          <a href="how-it-works/" class="btn btn--ghost btn--tiny">Learn more</a>
        </div>
        <div class="story__grid">
          <article class="story__phase">
            <h3>01 · Capture</h3>
            <p>
              Our archivists scan your environment with PortalCam, mapping
              every particle into a responsive gaussian splat.
            </p>
          </article>
          <article class="story__phase" id="portalcam">
            <h3>02 · Remaster</h3>
            <p>
              Proprietary reconstruction polishes depth, light, and emotional
              cues so your memory is vivid yet authentic.
            </p>
          </article>
          <article class="story__phase" id="login">
            <h3>03 · Relive</h3>
            <p>
              Sign into your memory vault to browse experiences, play them with
              family, and send each other memories (coming soon).
            </p>
          </article>
        </div>
      </section>

      <section class="cta-band" id="schedule">
        <div class="cta-band__content">
          <h2>Schedule your scan</h2>
          <p>
            Secure a visit from a PortalCam archivist. We'll prepare your space
            and capture your story with respect and care.
          </p>
          <a class="btn btn--accent" href="order/">Reserve a time</a>
        </div>
      </section>

      <section class="testimonials" him id="testimonials">
        <h2>Stories held in the archive</h2>
        <div class="testimonials__grid">
          <figure class="testimonial">
            <blockquote>
              "The guys at Remnant captured every detail of my grandmother's studio.
              It's like stepping back into her creative world."
            </blockquote>
            <figcaption>— Aya, Memory Capsule #219</figcaption>
          </figure>
          <figure class="testimonial">
            <blockquote>
              "Seeing our wedding venue as a living experience again made our
              anniversary unforgettable."
            </blockquote>
            <figcaption>— Malik & Rey, Capsule #312</figcaption>
          </figure>
        </div>
      </section>
    </main>

    <footer class="footer" id="support">
      <div class="footer__col">
        <h2 class="sr-only">Remnant footer</h2>
        <p class="footer__tagline">
          Remnant preserves the spaces that hold your memories.
        </p>
      </div>
      <div class="footer__col">
        <h3>Support</h3>
        <ul>
          <li><a href="#">FAQ</a></li>
          <li><a href="#">PortalCam prep guide</a></li>
          <li><a href="#">Contact archivist</a></li>
        </ul>
      </div>
      <div class="footer__col">
        <h3>Policies</h3>
        <ul>
          <li><a href="#">Privacy</a></li>
          <li><a href="#">Terms</a></li>
          <li><a href="#">Accessibility</a></li>
        </ul>
      </div>
    </footer>

    <script
      src="https://unpkg.com/@elevenlabs/convai-widget-embed"
      async
      type="text/javascript"
    ></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script type="module" src="scripts/main.js"></script>
  </body>
  <script>
    /* ==== Supabase config (EDIT THESE) ==== */
    const SUPABASE_URL = "https://vtzwjjzmptokrxslfbra.supabase.co";
    const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZ0endqanptcHRva3J4c2xmYnJhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjA2NDk3OTIsImV4cCI6MjA3NjIyNTc5Mn0.g-iatnLPgDERvKcMahD545_qMdYIFDlLeylqtRMz2AM";
    /* ====================================== */

    // Create client
    const sb = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

    // Elements (desktop + mobile badges)
    const desktopBadge   = document.querySelector('[data-auth-status]');
  const desktopEmailEl = document.querySelector('[data-auth-email]');
  const mobileBadge    = document.querySelector('[data-auth-status-mobile]');
  const mobileEmailEl  = document.querySelector('[data-auth-email-mobile]');

  function showBadges(email){
    if (desktopEmailEl) desktopEmailEl.textContent = email;
    if (mobileEmailEl)  mobileEmailEl.textContent  = email;
    if (desktopBadge)   desktopBadge.hidden = false;  // removes [hidden]
    if (mobileBadge)    mobileBadge.hidden  = false;  // removes [hidden]
  }
  function hideBadges(){
    if (desktopBadge)   desktopBadge.hidden = true;
    if (mobileBadge)    mobileBadge.hidden  = true;
    if (desktopEmailEl) desktopEmailEl.textContent = "";
    if (mobileEmailEl)  mobileEmailEl.textContent  = "";
  }

  async function refreshAuthUI(){
    const { data, error } = await sb.auth.getUser();
    if (error || !data?.user) return hideBadges();
    const email = data.user.email || data.user.user_metadata?.email || "";
    email ? showBadges(email) : hideBadges();
  }

  document.addEventListener('DOMContentLoaded', refreshAuthUI);

  sb.auth.onAuthStateChange((_event, session) => {
    const email = session?.user?.email || session?.user?.user_metadata?.email || "";
    email ? showBadges(email) : hideBadges();
  });
</script>
</html>
